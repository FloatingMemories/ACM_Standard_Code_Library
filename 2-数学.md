# 数学

## 线性基

### 异或空间线性基

#### 贪心法

可查询最大异或和

```cpp
struct BasisGreedy{
	ULL p[64];
	BasisGreedy(){memset(p, 0, sizeof p);}
	void insert(ULL x) {
		for (int i = 63; ~i; --i) {
			if (!(x >> i))  // x 的第 i 位是 0
				continue;
			if (!p[i]) {
				p[i] = x;
				break;
			}
			x ^= p[i];
		}
	}
	ULL query_max(){
		ULL ans = 0;
		for (int i = 63; ~i; --i) {
			ans = std::max(ans, ans ^ p[i]);
		}
		return ans;
	}
};
```

#### 高斯消元法

可查询任意大异或和

```cpp
struct BasisGauss{
	vector<ULL> a;
	LL n, tmp, cnt;
	
	BasisGauss(){a = {0};}
	
	void insert(ULL x){
		a.push_back(x);
	}
	
	void init(){
		n = (LL)a.size() - 1;
		LL k=1;
		for(int i=63;i>=0;i--){
			int t=0;
			for(LL j=k;j<=n;j++){
				if((a[j]>>i)&1){
					t=j;
					break;
				}
			}
			if(t){
				swap(a[k],a[t]);
				for(LL j=1;j<=n;j++){
					if(j!=k&&(a[j]>>i)&1) a[j]^=a[k];
				}
				k++;
			}
		}
		cnt = k-1;
		tmp = 1LL << cnt;
		if(cnt==n) tmp--;
	}
	
	LL query_xth(LL x){ // 从小到大，若x为负数，则查询倒数第几个
		if(x<0) x = tmp + x + 1;
		if(x>tmp) return -1;
		else{
			if(n>cnt) x--;
			LL ans=0;
			for(LL i=0; i<cnt; i++){
				if((x>>i)&1) ans^=a[cnt-i];
			}
			return ans;
		}
	}
};
```
